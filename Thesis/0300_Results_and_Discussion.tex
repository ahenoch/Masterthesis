\chapter{Results and Discussion} \label{chap:Results_and_Discussion}

For a basic overview of the sequences in the FASTA file (\autoref{chap:Materials_and_Methods}), the number of sequences of a segment related to specific subtypes was counted and visualized (\autoref{fig:Frequency}). Hereby, the high number of segment 4 sequences of subtype H1 and H3 in \autoref{subfig:Frequency_4} and segment 6 sequences of N1 and N2 in \autoref{subfig:Frequency_6} was noticeable. Furthermore, the similarity of the number of sequences of segment 4 subtype H1 and N1 as well as of segment 6 H3 and N2 was also remarkable. The similarity seems to be most likely due to the frequency of subtype combinations H1N1 and H3N2 of the full genomes, which was also in line with the most prominent subtypes of \gls{IAV} mentioned in \textcite{deng_simplified_2015}. 

\begin{figure}[!hbt]
    \centering
    %\begin{adjustbox}{minipage=\dimexpr\textwidth-2\fboxsep-2\fboxrule,fbox}
    \begin{subfigure}[b]{\textwidth}
        \caption[Segment 4 \Acrlong{HA}]{\textbf{Segment 4 (\Acrlong{HA})}}
        \label{subfig:Frequency_4}            \includegraphics[width=\textwidth]{PCA/Data_Overview_Segment_4_H.pdf}
    \end{subfigure}
    \vskip\baselineskip
    \begin{subfigure}[b]{\textwidth}
        \caption[Segment 6 \Acrlong{NA}]{\textbf{Segment 6 (\Acrlong{NA})}}
        \label{subfig:Frequency_6}            \includegraphics[width=\textwidth]{PCA/Data_Overview_Segment_6_N.pdf}
    \end{subfigure}
    \caption[Antigen subtype frequency]{\textbf{Antigen subtype frequency.} The number of occurrences of segment 4 and segment 6 sequences related to antigen subtypes is visualized. Sequences related to subtypes H1 and H3 are the most frequent ones from segment 4 with a total number of 17627 and 23074. Subtype H5 is also slightly over-represented with 3195 sequences. 1191 sequences from segment 4 in the data have no classification and are listed as \glqq none\grqq{}. Sequences related to subtypes N1 and N2 are the most frequent ones from segment 6 with a total number of 17945 and 26129. 1305 sequences from segment 6 in the data have no classification and are also listed as \glqq none\grqq{}.}
    \label{fig:Frequency}
\end{figure}
% \begin{figure}[!hbt]
%     \centering
%     %\includegraphics[width=\dimexpr\textwidth-2\fboxsep-2\fboxrule,fbox]{PCA/Data_Overview_Segment_4_H.pdf}
%     \includegraphics[width=\textwidth]{PCA/Data_Overview_Segment_4_H.pdf}
%     \caption[Segment 4 \Acrlong{HA} Antigen Subtype Frequency]{\textbf{Segment 4 \Acrlong{HA} Antigen Subtype Frequency.} The number of occurrences of a segment 4 sequence related to a specific \gls{HA} antigen subtype is visualized. Sequences related to subtypes H1 and H3 are the most frequent ones from segment 4 with a total number of 17627 and 23074. Subtype H5 is also slightly over-represented with 3195 sequences. 1191 sequences from segment 4 in the data have no classification and are listed as \glqq none\grqq{}.}
%     \label{fig:Frequency_4}
% \end{figure}
% \begin{figure}[!hbt]
%     \centering
%     %\includegraphics[width=\dimexpr\textwidth-2\fboxsep-2\fboxrule,fbox]{PCA/Data_Overview_Segment_6_N.pdf}
%     \includegraphics[width=\textwidth]{PCA/Data_Overview_Segment_6_N.pdf}
%     \caption[Segment 6 \Acrlong{NA} Antigen Subtype Frequency]{\textbf{Segment 6 \Acrlong{NA} Antigen Subtype Frequency.} The number of occurrences of a segment 6 sequence related to a specific \gls{NA} antigen subtype is visualized. Sequences related to subtypes N1 and N2 are the most frequent ones from segment 6 with a total number of 17945 and 26129. 1305 sequences from segment 6 in the data have no classification and are listed as \glqq none\grqq{}.}
%     \label{fig:Frequency_6}
% \end{figure}

In addition to the most frequent subtypes a, high number of not classified sequences named \glqq none\grqq{} is present in the data. These unclassified strains were possibly sequenced without prior subtype testing or are in fact sequences that do not belong to either of the known subtypes and, thereby, no antibody antigen reaction was observable \autocite{noauthor_revision_1980}.

\vspace{1em}

As described in \autoref{chap:Materials_and_Methods}, the clustering was performed multiple times to compare different methods for their quality and efficiency of \gls{IAV} clustering. The four methods are compared directly to each other in the following. For better separation, the four methods were called by their abbreviation, to be found in \autoref{tab:methods}. As a short reminder, PD uses direct reduction to 30 components with \texttt{PCA} following $\varepsilon$ exploration using the \gls{DBCV} and PK using the same reduction but exploration with the Kneedle Algorithm instead. Method UD and UK are performed in a similar way but using reduction to 100 components by \texttt{PCA} and to 30 afterwards by \texttt{UMAP} instead. The numbered workflows in \autoref{fig:Vectorization_Pipeline}, \autoref{fig:Clustering_Pipeline} and \autoref{fig:Tree_Pipeline} represent the different to be compared methods.

\vspace{1em}

To choose a reasonable number of components for the \texttt{PCA} mentioned in \autoref{sec:PCA}, the 7-mer frequency vectors of segment 4 (\autoref{fig:Vectorization_Pipeline}) were reduced by running \texttt{PCA} with different settings. The sum of explained variance for every setting were calculated and listed in \autoref{tab:PCA_Dimension}. Because of the high increase of explained variance from 10 to 20 components with 58.7\% to 68.7\% and likewise to 30 components with 73.9\% explained variance, a value of 30 was used as default in this project. A fairly small value was used, due to increasing computational effort of the \texttt{PCA} implementation and also to preserve the usability of spanning tree calculation with \texttt{HDBSCAN}. Calculation of the spanning tree is with \texttt{HDBSCAN} and the preferred settings, only possible to less than 60 components. For better comparison of the methods, the number of final components for \texttt{UMAP} reduction in UD and UK was also set to 30. Therefore, clustering is with all used methods was performed on vectors with 30 components.

\begin{table}[!hbt]
    \centering
    \caption[Explained variance by different PCA settings]{\textbf{Explained variance by different PCA settings.} The explained variance of specific \texttt{PCA} settings used on the 7-mer frequency vectors of segment 4. A result of 0.587 as for 10 components represents 58.7\% of the variance is explained by the first 10 components of the vector. The more components are extracted the lower the increase in additional explained variance \autocite{pearson_liii_1901}.}
    \label{tab:PCA_Dimension}
    \pgfplotstabletypeset[
        every head row/.style={
            before row={
                \toprule
            },
            after row={
                \midrule
            },
        },
        every last row/.style={
            after row={
                \bottomrule
            },
        },
        begin table=\begin{tabular*}{.5\textwidth},
        end table=\end{tabular*},
        columns={0,1},
        columns/0/.style={int detect, multicolumn names=l,column name=\textbf{\#Components}, column type=@{\extracolsep{\fill}\hspace{6pt}}r},
        columns/1/.style={multicolumn names=l,column name=\textbf{$\text{Var}(X)$}, column type=r}
    ]
    {Graphics/PCA.csv}
\end{table}

\begin{figure}[!hbt]
    \centering
    %\begin{adjustbox}{minipage=\dimexpr\textwidth-2\fboxsep-2\fboxrule,fbox}
    \begin{subfigure}[b]{0.475\textwidth}
        \caption[Dimension Reduction with \texttt{PCA}]{\textbf{Dimension Reduction with \texttt{PCA}}}
        \label{subfig:Normalisation_PCA}            \includegraphics[width=\textwidth]{PCA/Difference_Distance_Calculation.pdf}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.475\textwidth}
        \caption[Dimension Reduction with \texttt{UMAP}]{\textbf{Dimension Reduction with \texttt{UMAP}}}
        \label{subfig:Normalisation_UMAP}            \includegraphics[width=\textwidth]{UMAP/Difference_Distance_Calculation.pdf}
    \end{subfigure}
    %\end{adjustbox}
    \caption[Approximation proof on real data]{\textbf{Approximation proof on real data.} Calculations for the L2-norm normalized euclidean and the cosine distances were performed on subsets for both pipelines and compared. In both cases the difference is exactly matching the proportional increase of squared euclidean distance divided by two equals the cosine distance as described in \autoref{sec:HDBSCAN}. Crowding of the points in the right graph representing reduction with \texttt{UMAP} is explained by the embedding mechanism of the tool further reduction the distance of similar vectors \autocite{mcinnes_umap_2020}.}
    \label{fig:Normalisation_Methods}
\end{figure}

\vspace{1em}

For a graphical comparison of the demonstrated mathematical proof of the proportional increase of the euclidean distance of the L2-norm normalied vectors to the cosine distance (\autoref{sec:HDBSCAN}), subsets of the real data were used. In \autoref{subfig:Normalisation_PCA}, a subset of 100 7-mer frequency vectors of segment 4 were reduced by \texttt{PCA} and compared to each other by chord and cosine distance as described in \autoref{sec:HDBSCAN} and \autoref{sec:PCA}. All the calculated distances for chord distance were then plotted against the equivalent cosine distances. The red line indicates the proportional increase as calculated in \autoref{sec:HDBSCAN}. All the points are arranged exactly along the red line which confirms the calculation and proportionality of the used method to cosine distance that was intended to be used. The same was repeated for the settings with the use of the \texttt{UMAP} pipeline resulting in the same graphical confirmation (\autoref{subfig:Normalisation_UMAP}). In \autoref{subfig:Normalisation_UMAP}, all the points are crowded much more to a dense area of the curve. This is reasoned by the embedding behavior of \texttt{UMAP} and will be discussed in the following sections.

\input{Thesis/0301_Clustering}

\input{Thesis/0302_Anomalies}

\input{Thesis/0303_K_mer_Representation}

\input{Thesis/0304_Comparison_Clustering}

\input{Thesis/0305_Dimension_Reduction}

\input{Thesis/0306_Serotype_Classification}